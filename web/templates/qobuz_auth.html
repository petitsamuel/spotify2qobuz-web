{% extends "base.html" %}

{% block title %}Connect Qobuz{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-8">
    <div class="text-center">
        <h1 class="text-3xl font-bold mb-4">Connect Qobuz</h1>
        <p class="text-gray-400">Qobuz doesn't have a public API, so we need to grab your auth token from the browser.</p>
    </div>

    <!-- Method 1: Manual token (now primary) -->
    <div class="bg-gray-800 rounded-lg p-6 border border-blue-500" x-data="{ showInstructions: true }">
        <div class="flex items-center gap-2 mb-4">
            <h2 class="text-xl font-semibold">Get Token from Browser</h2>
            <span class="px-2 py-1 bg-blue-600/20 text-blue-400 rounded text-xs">Recommended</span>
        </div>

        <div class="bg-gray-700 rounded-lg p-4 mb-4 text-sm space-y-4">
            <div class="flex gap-3">
                <span class="flex-shrink-0 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs font-bold">1</span>
                <p>Open <a href="https://play.qobuz.com" target="_blank" class="text-blue-400 hover:underline font-medium">play.qobuz.com</a> in a new tab and log in</p>
            </div>
            <div class="flex gap-3">
                <span class="flex-shrink-0 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs font-bold">2</span>
                <p>Open DevTools: <kbd class="px-2 py-1 bg-gray-600 rounded text-xs">F12</kbd> or <kbd class="px-2 py-1 bg-gray-600 rounded text-xs">Cmd+Option+I</kbd></p>
            </div>
            <div class="flex gap-3">
                <span class="flex-shrink-0 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs font-bold">3</span>
                <p>Go to <strong>Network</strong> tab, then play any song or click around</p>
            </div>
            <div class="flex gap-3">
                <span class="flex-shrink-0 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs font-bold">4</span>
                <p>Filter by <code class="px-2 py-1 bg-gray-600 rounded">api.json</code> and click any request</p>
            </div>
            <div class="flex gap-3">
                <span class="flex-shrink-0 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs font-bold">5</span>
                <p>In Headers, find <code class="px-2 py-1 bg-gray-600 rounded">X-User-Auth-Token</code> and copy the value</p>
            </div>
        </div>

        <form action="/auth/qobuz/token" method="POST" class="space-y-4">
            <div>
                <label for="token" class="block text-sm font-medium text-gray-300 mb-2">Paste your token here:</label>
                <input
                    type="text"
                    id="token"
                    name="token"
                    required
                    placeholder="X-User-Auth-Token value"
                    class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm"
                />
            </div>
            <button type="submit" class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-500 rounded-lg font-semibold transition">
                Connect Qobuz
            </button>
        </form>
    </div>

    <!-- Visual guide -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h3 class="font-semibold mb-3">Where to find the token:</h3>
        <div class="bg-gray-900 rounded-lg p-4 font-mono text-xs overflow-x-auto">
            <div class="text-gray-500">Request Headers:</div>
            <div class="mt-2 space-y-1">
                <div><span class="text-gray-400">Accept:</span> application/json</div>
                <div><span class="text-gray-400">Origin:</span> https://play.qobuz.com</div>
                <div class="bg-yellow-500/20 px-2 py-1 rounded"><span class="text-yellow-400">X-User-Auth-Token:</span> <span class="text-green-400">your-token-here-copy-this</span></div>
                <div><span class="text-gray-400">X-App-Id:</span> 798273057</div>
            </div>
        </div>
    </div>

    <div class="text-center">
        <a href="/" class="text-gray-400 hover:text-white">‚Üê Back to Home</a>
    </div>
</div>
{% endblock %}
